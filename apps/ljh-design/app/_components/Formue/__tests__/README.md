# Formue组件测试文档

## 测试文件说明

本目录包含Formue相关组件的测试用例。为了方便管理和运行，我们提供了两种测试文件组织方式：

1. **独立测试文件**：每个组件有单独的测试文件，便于针对特定组件进行测试和调试
   - Form.test.tsx - 表单功能测试
   - FormueItem.test.tsx - 表单项组件测试
   - FormueMain.test.tsx - 主内容区域测试
   - ShowHead.test.tsx - 详情页头部测试
   - ShowOption.test.tsx - 详情页选项测试
   - ShowPage.test.tsx - 详情页测试

2. **合并测试文件**：`FormueTests.tsx` 将所有测试集合在一起，便于一次性运行所有测试

## 合并测试文件优势

- 减少重复的模拟设置代码
- 统一管理所有测试依赖
- 避免跨测试文件的模拟冲突
- 方便一次性运行所有测试

## 使用方法

### 运行所有测试

```bash
pnpm test FormueTests.tsx
```

### 运行特定组件的测试

```bash
pnpm test Form.test.tsx
```

## 测试覆盖范围

- 表单创建和编辑功能
- 作品项显示和交互
- 作品详情页展示
- 用户交互功能（点赞、收藏、评论等）
- 主内容区域的展示和搜索功能

## 注意事项

1. 所有测试使用 Vitest 和 React Testing Library
2. 大部分外部依赖都使用了模拟（mock）处理
3. 编写新测试时，请参考现有测试的模式和结构

## 用户作品展示与浏览

**测试文件**: `FormueMain.test.tsx`

测试覆盖了以下功能：
1. 正确渲染作品列表和展示组件
2. 加载状态显示骨架屏
3. 搜索功能正确更新URL
4. 发布新帖链接正确工作

## 用户作品的点赞与收藏

**测试文件**: `ShowOption.test.tsx`

测试覆盖了以下功能：
1. 点赞按钮的状态显示与交互
   - 未点赞状态下点击调用点赞API
   - 已点赞状态下点击调用取消点赞API
   - 点赞状态显示正确
   - 禁用状态正确控制

2. 收藏按钮的状态显示与交互
   - 未收藏状态下点击调用收藏API
   - 已收藏状态下点击调用取消收藏API
   - 收藏状态显示正确
   - 禁用状态正确控制

## 用户作品的评论功能

**测试文件**: `quill.test.tsx`

测试覆盖了以下功能：
1. 评论编辑器正确渲染
2. 评论列表正确显示
3. 提交评论前进行内容验证
4. 评论成功后刷新列表
5. 评论加载状态处理

## 用户作品的复制功能

**测试文件**: `ShowHead.test.tsx`

测试覆盖了以下功能：
1. 作品头部信息正确显示
2. 模板类型作品的克隆功能
   - 克隆对话框正确显示
   - 提交表单调用克隆API
   - 克隆成功后更新列表
 
3. 素材类型作品的克隆功能
   - 克隆对话框正确显示
   - 名称验证
   - 提交表单调用克隆素材API
   - 克隆成功后更新列表

4. 只对非作者显示克隆按钮

## 好友功能

**测试文件**: `FirdentItem.test.tsx`

测试覆盖了以下功能：
1. 用户信息正确显示
2. 好友状态判断与显示
   - 非好友状态显示添加按钮
   - 已是好友状态显示对应文本
   - 待处理请求状态显示对应文本
3. 添加好友功能
   - 点击添加好友调用添加API
   - 添加成功后刷新好友列表
4. 加载状态处理

## 运行测试

使用以下命令运行测试：

```bash
pnpm run test
```

## 注意事项

1. 测试依赖于正确模拟的组件和API，确保模拟对象与实际实现匹配。
2. 如果测试失败，请检查模拟的组件和钩子函数是否符合最新的实现。
3. 可能需要根据实际代码的变化，定期更新测试用例。
4. 确保模拟函数的参数与实际API保持一致。 